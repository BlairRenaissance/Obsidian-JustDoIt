#Android  

![](https://raw.githubusercontent.com/BlairRenaissance/ImageHost/main/20240131220021.png)


Android系统由上至下，分为五个部分：

1. **应用程序层(System Apps)** ：Android 装配了一个核心应用程序集合，包括 E-mail 客户端、SMS 短消息程序、日历、地图、浏览器、联系人管理程序和其他程序，所有应用程序都是用 Java 编程语言编写的。用户开发的 Android 应用程序和 Android 的核心应用程序是同一层次的，它们都是基于 Android 的系统 API 构建的。（即所有安装到手机的应用程序都属于这一层，比如系统自带的联系人、短信等，或者是你从应用商店下载的所有app，当然也包括你自己开发的应用程序）

2. **应用程序框架层(Application Framework/Java** **API** **Framework)** ：应用程序的体系结构旨在简化组件的重用，任何应用程序都能发布它的功能且任何其他应用程序都可以使用这些功能（需要服从框架执行的安全限制），这一机制允许用户替换组件。开发者完全可以访问核心应用程序所使用的 API 框架。通过提供开放的开发平台，Android 使开发者能够编制极其丰富和新颖的应用程序。开发者可以自由地利用设备硬件优势访问位置信息、运行后台服务、设置闹钟、向状态栏添加通知等。(这一层主要提供了构建应用程序时可能用到的各种API，Android自带的一些核心应用就是使用这些API完成的，开发者也可以自行使用这些API进行自己App的开发。)这一层是编写Google发布的核心应用时所使用的API框架，开发人员同样可以使用这些框架来开发自己的应用，这样便简化了程序开发的结构设计，但是必须要遵守其框架的开发原则。

所有的应用程序都是由一系列的服务和系统组成的，主要包括以下几种：

|**服务**       |**英文名称**|**说明**|
|-----|---|---|
|视图|View|这里的视图指的是丰富的、可扩展的视图集合，可用于构建一个应用程序，包括列表 (Lists)、网格 (Grids)、文本框 (TextBoxes)、按钮 (Buttons)，甚至是内嵌的 Web 浏览器。|
|内容管理器|Content Provider|内容管理器使得应用程序可以访问另一个应用程序的数据（如联系人数据库）或者共享自己的数据。|
|资源管理器|Resource Manager|资源管理器提供访问非代码资源，如本地字符串、图形和分层文件 (layout files)。|
|通知管理器|Notification Manager|通知管理器使得所有的应用程序都能够在状态栏显示通知信息。|
|活动管理器|Activity Manager|在大多数情况下，每个 Android 应用程序都运行在自己的 Linux 进程中。当应用程序的某些代码需要运行时，这个进程就被创建并一直运行下去，直到系统认为该进程不再有用为止，然后系统将回收该进程占用的内存以便分配给其他的应用程序。活动管理器管理应用程序生命周期，并且提供通用的导航回退功能。|

3. **系统运行库层(C/C++库及Android运行库)** ：Android 本地框架是由 C/C++ 实现的，包含 C/C++ 库，以供 Android 系统的各个组件使用。这些功能通过 Android 的应用程序框架为开发者提供服务。这一层通过一些C/C++库来为Android提供主要的特性支持。如SQLite库提供了数据库的支持，OpenGL|ES库提供了3D绘图的支持，Webkit库提供了浏览器内核的支持等。同样在这一层还要Android运行时库，它主要提供了一些核心库，能够允许开发者使用Java语言来编写Android程序。不仅如此，它还包括了Dalvik虚拟机（android5.0后改为ART运行环境），它使得每一个android程序可以运行在独立的进程中，并且拥有自己的Dalvik虚拟机实例。相较于Java虚拟机，Dalvik是专门为移动设备定制的，它针对手机内存、CPU性能有限等情况做了优化处理。

|**名称**|**说明** |
|---|---|
|系统C语言库|标准C语言系统库 (libc) 的 BSD 衍生，调整为基于嵌入式 Linux 设备。|
|媒体库|基于 PacketVideo 的 OpenCORE，这些库支持播放和录制许多流行的音频和视频格式，以及静态图像文件，包括 MPEG4、H.264、MP3、AAC、AMR、JPG、PNG。|
|界面管理|管理访问显示子系统，并且为多个应用程序提供 2D 和 3D 图层的无缝融合。|
|LibWebCore|新式的 Web 浏览器引擎，支持 Android 浏览器和内嵌的 Web 视图。|
|SGL|一个内置的 2D 图形引擎。|
|3D 库|基于 OpenGL ES 1.0 APIs 实现，该库可以使用硬件 3D 加速或包含高度优化的 3D 软件光栅。|
|FreeType|位图和矢量字体显示渲染。|
|SQLite|SQLite 是一个所有应用程序都可以使用的强大且轻量级的关系数据库引擎。|

4. **硬件抽象层(** **Hardware** **Abstraction Layer,HAL)** ：硬件抽象层 (HAL) 提供标准界面，向更高级别的 Java API 框架显示设备硬件功能。HAL 包含多个库模块，其中每个模块都为特定类型的硬件组件实现一个界面，例如：Audio音频模块，BlueTooth：蓝牙模块，Camera：相机模块，Sensors:传感器。系统内置对传感器的支持达13种，他们分别是：加速度传感器(accelerometer)、磁力传感器(magnetic field)、方向传感器(orientation)、陀螺仪(gyroscope)、环境光照传感器(light)、压力传感器(pressure)、温度传感器(temperature)和距离传感器(proximity)等。当框架 API 要求访问设备硬件时，Android 系统将为该硬件组件加载库模块。厂商会在这层定义自己的**HAL接口**。

5. **Linux内核层(Linux Kernel)** ：众所周知，Android系统是基于Linux内核层提供核心系统服务，例如安全、内存管理、进程间通信、网络堆栈、驱动模型。这一层为android设备的各种硬件提供了底层的强大驱动，除了标准Linux内核外，Android还增加了内核的驱动程序，如显示驱动、音频驱动、照相机驱动、蓝牙驱动、Wi-Fi驱动、电源管理等。



