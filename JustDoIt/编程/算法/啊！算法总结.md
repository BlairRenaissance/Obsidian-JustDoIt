
## äºŒå‰æ ‘

- [äºŒå‰æ ‘åŸºç¡€åŠå¸¸è§ç±»å‹](https://labuladong.online/algo/data-structure-basic/binary-tree-basic/)
- [äºŒå‰æ ‘çš„é€’å½’/å±‚åºéå†](https://labuladong.online/algo/data-structure-basic/binary-tree-traverse-basic/)


---

## äºŒåˆ†æŸ¥æ‰¾

### äºŒåˆ†æ¨¡æ¿

#### å·¦é—­å³é—­ \[ ]

é€‚ç”¨äºæŸ¥æ‰¾å¯ä»¥é€šè¿‡è®¿é—®æ•°ç»„ä¸­çš„**å•ä¸ªç´¢å¼•**æ¥ç¡®å®šçš„å…ƒç´ æˆ–æ¡ä»¶ã€‚

âš ï¸ç‰¹åˆ«æ³¨æ„ï¼š
- é€‚ç”¨äºç²¾ç¡®æŸ¥æ‰¾ç›®æ ‡å€¼ï¼ˆ`nums[mid] == target`ï¼‰ã€‚
- å·¦é—­å³é—­ï¼Œright ä¹Ÿå¿…é¡»æ˜¯æœ‰æ•ˆçš„ç´¢å¼•å€¼ï¼Œæ‰€ä»¥æ˜¯ size - 1ï¼š`int right = nums.size() - 1;`
- æ¯æ¬¡è¿­ä»£ä¼šæ’é™¤midï¼ˆå› ä¸ºmidå·²ç»æ£€æŸ¥è¿‡ï¼‰ã€‚
- ç»ˆæ­¢æ—¶left > rightï¼Œè¡¨ç¤ºæœªæ‰¾åˆ°ç›®æ ‡å€¼ã€‚

``` cpp
int binarySearch(vector<int>& nums, int target){
  if(nums.size() == 0)
    return -1;

  int left = 0;
  int right = nums.size() - 1; // ç‰¹åˆ«æ³¨æ„ï¼Œç”±äºæ˜¯å·¦é—­å³é—­ï¼Œæ‰€ä»¥è¿™é‡Œè¦æ˜¯size-1
  while(left <= right){
    // Prevent (left + right) overflow
    int mid = left + (right - left) / 2;
    if(nums[mid] == target){ return mid; }
    else if(nums[mid] < target) { left = mid + 1; }
    else { right = mid - 1; }
  }

  // End Condition: left > right
  return -1;
}
```


âš ï¸ç‰¹åˆ«æ³¨æ„ï¼š
- é€‚ç”¨äºæŸ¥æ‰¾æ’å…¥ä½ç½®æˆ–æœ€æ¥è¿‘çš„å€¼ï¼ˆå¦‚findClosestElementsï¼‰ã€‚
- å·¦é—­å³é—­ï¼Œright ä¹Ÿå¿…é¡»æ˜¯æœ‰æ•ˆçš„ç´¢å¼•å€¼ï¼Œæ‰€ä»¥æ˜¯ size - 1ï¼š`int right = nums.size() - 1;`
- right = midä¿ç•™midåœ¨åŒºé—´å†…ï¼ˆå¯èƒ½ä¸ºç›®æ ‡å€¼ï¼‰ã€‚
- ç»ˆæ­¢æ—¶left == rightï¼ŒæŒ‡å‘å”¯ä¸€å€™é€‰ä½ç½®ã€‚

``` cpp
int left = 0, right = arr.size() - 1;  
while (left < right) {  
    int mid = left + (right - left) / 2;  
    if(arr[mid] < x) {  
        left = mid + 1;  
    } else {  
        right = mid;  
    }  
}
return left;
```

#### å·¦é—­å³å¼€ \[ )

é€‚ç”¨äºæŸ¥æ‰¾éœ€è¦è®¿é—®æ•°ç»„ä¸­**å½“å‰ç´¢å¼•åŠå…¶ç›´æ¥å³é‚»å±…ç´¢å¼•**çš„å…ƒç´ æˆ–æ¡ä»¶ã€‚

âš ï¸ç‰¹åˆ«æ³¨æ„ï¼š
- å·¦é—­å³å¼€ï¼Œæ‰€ä»¥ right æ˜¯ sizeï¼š`int right = nums.size();`
- å‘ä¸‹å–æ•´ï¼š`int mid = left + (right - left) / 2; // å‘ä¸‹å–æ•´`

``` cpp
int binarySearch(vector<int>& nums, int target){
  if(nums.size() == 0)
    return -1;

  int left = 0;
  int right = nums.size();
  while(left < right){
    // Prevent (left + right) overflow
    int mid = left + (right - left) / 2;
    if(nums[mid] == target){ return mid; }
    else if(nums[mid] < target) { left = mid + 1; }
    else { right = mid; }
  }

  // Post-processing:
  // End Condition: left == right
  if(left != nums.size() && nums[left] == target) return left;
  return -1;
}
```

#### å·¦å¼€å³é—­ (]

é€‚ç”¨äºæŸ¥æ‰¾éœ€è¦è®¿é—®æ•°ç»„ä¸­**å½“å‰ç´¢å¼•åŠå…¶ç›´æ¥å·¦é‚»å±…ç´¢å¼•**çš„å…ƒç´ æˆ–æ¡ä»¶ã€‚

âš ï¸ç‰¹åˆ«æ³¨æ„ï¼š
- å·¦å¼€å³é—­ï¼Œright ä¹Ÿå¿…é¡»æ˜¯æœ‰æ•ˆçš„ç´¢å¼•å€¼ï¼Œæ‰€ä»¥æ˜¯ size - 1ï¼š`int right = nums.size() - 1;`
- å‘ä¸Šå–æ•´ï¼š`int mid = left + (right - left + 1) / 2; // å‘ä¸Šå–æ•´`

``` cpp
int binarySearch(vector<int>& nums, int target){
  if(nums.size() == 0)
    return -1;
    
  int left = 0;
  int right = nums.size() - 1;
  
  while(left < right){
    // é‡ç‚¹å·®å¼‚åœ¨è¿™é‡Œï¼Œå› ä¸ºæ˜¯æŠŠå³ä¾§ä½œä¸ºä¸»ä½“ï¼Œå’Œå·¦ä¾§å…ƒç´ æ¯”è¾ƒ
	// æ‰€ä»¥è¿™é‡Œå‘ä¸Šå–æ•´å¾ˆå…³é”®
    int mid = left + (right - left + 1) / 2;
    ...
  }
}
```

#### å·¦å¼€å³å¼€ ( )

é€‚ç”¨äºæŸ¥æ‰¾éœ€è¦è®¿é—®æ•°ç»„ä¸­**å½“å‰ç´¢å¼•åŠå…¶ç›´æ¥å·¦å³é‚»å±…ç´¢å¼•**çš„å…ƒç´ æˆ–æ¡ä»¶ã€‚

``` cpp
int binarySearch(vector<int>& nums, int target){
    if (nums.size() == 0)
        return -1;

    int left = 0, right = nums.size() - 1;
    while (left + 1 < right){
        // Prevent (left + right) overflow
        int mid = left + (right - left) / 2;
        if (nums[mid] == target) {
            return mid;
        } else if (nums[mid] < target) {
            left = mid;
        } else {
            right = mid;
        }
    }

    // Post-processing:
    // End Condition: left + 1 == right
    if(nums[left] == target) return left;
    if(nums[right] == target) return right;
    return -1;
}
```

### ç»å…¸é¢˜å‹

#### æ—‹è½¬æ•°ç»„

LC 33 /  153 / 162

> [!Tip]
> é‡ç‚¹æ˜¯çœ‹ä»€ä¹ˆæ—¶å€™â€œæ‘”ä¸‹æ‚¬å´–â€ã€‚

æ¯”å¦‚`nums = [4,5,6,7,0,1,2]`ï¼š
- `if nums[0] <= nums[I]`Â é‚£ä¹ˆÂ `nums[0]`Â åˆ°Â `nums[i]`Â ä¸ºæœ‰åºæ•°ç»„ã€‚
- `if nums[i] < nums[0]` é‚£ä¹ˆåœ¨ 0ï½i åŒºé—´çš„æŸä¸ªç‚¹å¤„æ‘”ä¸‹äº†æ‚¬å´–ï¼Œé‚£ä¹ˆ i+1 åˆ°æœ€åä¸€ä¸ªæ•°å­—çš„åŒºé—´ä¸ºæœ‰åºæ•°ç»„ï¼Œå¹¶ä¸”æ‰€æœ‰çš„æ•°å­—éƒ½å°äº `nums[0]` ä¸”å¤§äº `nums[i]`ã€‚

``` cpp
int findMin(vector<int>& nums) {  
    int len = nums.size();  
    int left = 0, right = len - 1;  
    while(left < right) {  
        int pivot = left + (right - left) / 2;  
        if(nums[pivot] < nums[right]) {  
            // å½“ nums[pivot] < nums[right] æ—¶ï¼Œpivot æœ¬èº«å¯èƒ½å°±æ˜¯æœ€å°å€¼  
            // æ‰€ä»¥ä¸å¯è·³è¿‡
            right = pivot;  
        } else {  
            // å·²çŸ¥numsäº’ä¸ç›¸åŒï¼Œleft+1 è·³è¿‡æ— æ•ˆåŒºé—´
            // pivotå·²ç»ä¸å¯èƒ½æ˜¯æˆ‘ä»¬åœ¨å¯»æ‰¾çš„æœ€å°å€¼
            // è¯´æ˜æœ€å°å€¼å¿…ç„¶åœ¨ pivot å³ä¾§ï¼ˆå« pivot+1ï¼‰  
            left = pivot + 1;  
        }  
    }  
    return nums[left];  
}

int findMax(vector<int>& nums) {  
    int len = nums.size();  
    int left = 0, right = len - 1;  
    while(left < right) {  
	    // å› ä¸ºæ˜¯æŠŠå³ä¾§ä½œä¸ºä¸»ä½“ï¼Œå’Œå·¦ä¾§å…ƒç´ æ¯”è¾ƒ
	    // æ‰€ä»¥è¿™é‡Œå‘ä¸Šå–æ•´å¾ˆå…³é”®
        int pivot = left + (right - left + 1) / 2;
        // pivotæ»šä¸‹æ‚¬å´–ï¼Œleftç•™åœ¨æœ€é«˜å³°
        if(nums[left] < nums[pivot]) {
            // å½“ nums[left] < nums[pivot] æ—¶ï¼Œpivot æœ¬èº«å¯èƒ½å°±æ˜¯æœ€å¤§å€¼
            // æ‰€ä»¥ä¸å¯è·³è¿‡  
            left = pivot;  
        } else {  
            // å·²çŸ¥numsäº’ä¸ç›¸åŒï¼Œpivotå·²ç»ä¸å¯èƒ½æ˜¯æˆ‘ä»¬åœ¨å¯»æ‰¾çš„æœ€å¤§å€¼
            // è¯´æ˜æœ€å¤§å€¼å¿…ç„¶åœ¨pivotå·¦ä¾§
            right = pivot - 1;  
        }  
    }  
    return nums[left];  
}
```


---

## åŒæŒ‡é’ˆ

### ç»å…¸é¢˜å‹

#### ä¸¤é“¾è¡¨äº¤ç‚¹

å°å·§æ€æ˜¯ a+c+b = b+c+aï¼ŒptrA å’Œ ptrB éƒ½ä»å¦ä¸€ä¸ªä¸²ä¸²ğŸ¢çš„å¤´éƒ¨å†æ¥ä¸€æ¬¡ã€‚

#### å¿«æ…¢æŒ‡é’ˆ

LC 287. å¯»æ‰¾é‡å¤æ•° 

> [!Tip]
> åœ¨è¿è¡ŒÂ `fast = fast.next.next`Â ä¹‹å‰ï¼Œéœ€è¦æ£€æŸ¥Â `fast`Â å’ŒÂ `fast.next`Â ä¸ä¸ºç©º

```
slow = a+b
fast = a + n(b+c) + b // næ˜¯å‡è®¾fastæŒ‡é’ˆå·²ç»è½¬äº†nåœˆ
fast = 2 * slow

==> a = c + (nâˆ’1)(b+c)
```

æ„å‘³ç€æ–°èµ·ä¸¤ä¸ªæŒ‡é’ˆï¼Œåˆ†åˆ«ä»headå’Œç›¸é‡ç‚¹å¼€å§‹èµ°ï¼Œç›´åˆ°ç›¸é‡ï¼Œå°±æ˜¯ä¸€ä¸ªèµ°äº†aä¸€ä¸ªèµ°äº†cã€‚

#### å‡è„‘è¢‹

LC 2. ä¸¤æ•°ç›¸åŠ 
LC 21. åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨

å½“ç»“æœé“¾è¡¨æœ‰å¯èƒ½ä¸ºç©ºçš„æ—¶å€™ï¼Œå°±éœ€è¦å‡è„‘è¢‹ã€‚
``` cpp
ListNode* dummy = new ListNode(-1);
...
return dummy->next;
```

å¦‚æœè¿˜è®¾è®¡æ‹¼æ¥æ–°çš„é“¾è¡¨ï¼Œé‚£ä¹ˆå‡è„‘è¢‹éœ€è¦ä¸€ä¸ªæ–°çš„è¿­ä»£å™¨ã€‚
æ³¨æ„æ–°é“¾è¡¨çš„æ¯ä¸ªèŠ‚ç‚¹ä¸èƒ½æµ…æ‹·è´ï¼Œè€Œæ˜¯éœ€è¦æ–°æ„å»ºèŠ‚ç‚¹ã€‚
``` cpp
ListNode *iter = dummy; // ä» iter->next å¼€å§‹èµ‹æœ‰æ•ˆå€¼
iter->next = ptr1->val; // âŒ
iter->next = new ListNode(ptr1->val); // âœ…
```


---

## BFS & DFS
### 1.  Breadth First Search and Depth First Search

BFSï¼šç”¨ queue æ¥ç®¡ç†å¾…è®¿é—®çš„é¡¶ç‚¹ã€‚

![](https://raw.githubusercontent.com/BlairRenaissance/ImageHost/main/Clipboard_Screenshot_1752755956.png)


DFSï¼šç”¨ stack æ¥ç®¡ç†è¢«æŒ‚èµ·çš„é¡¶ç‚¹ã€‚

æ ¸å¿ƒæ€æƒ³ï¼šå½“ä½ ä»å½“å‰é¡¶ç‚¹å‘ç°ä¸€ä¸ªæœªè¢«è®¿é—®è¿‡çš„æ–°é¡¶ç‚¹æ—¶ï¼Œç®—æ³•ä¼šç«‹å³**æš‚åœå¯¹å½“å‰é¡¶ç‚¹çš„æ¢ç´¢**ï¼Œå°†å½“å‰é¡¶ç‚¹æŒ‚èµ·ï¼Œä¼˜å…ˆå»è®¿é—®æ–°é¡¶ç‚¹ï¼Œå¹¶é€’å½’åœ°ç»§ç»­è¿™ä¸ªè¿‡ç¨‹ã€‚

![](https://raw.githubusercontent.com/BlairRenaissance/ImageHost/main/Clipboard_Screenshot_1752756448.png)

---
### 2. Articulation Point and Biconnected Components å…³èŠ‚ç‚¹å’ŒåŒè¿é€šåˆ†é‡

![](https://raw.githubusercontent.com/BlairRenaissance/ImageHost/main/Clipboard_Screenshot_1752759699.png)

å›¾ä¸­è®²è§£çš„æ˜¯å›¾è®ºä¸­ **å…³èŠ‚ç‚¹ï¼ˆArticulation Pointï¼‰** å’Œ **åŒè¿é€šåˆ†é‡ï¼ˆBiconnected Componentsï¼‰** çš„æ¦‚å¿µï¼Œä»¥åŠå¦‚ä½•é€šè¿‡DFSæ¥è¯†åˆ«å®ƒä»¬ã€‚

1. **å…³èŠ‚ç‚¹ï¼ˆArticulation Pointï¼‰**ï¼š
    - å…³èŠ‚ç‚¹æ˜¯å›¾ä¸­çš„ â€œè„†å¼±ç‚¹â€ï¼Œç§»é™¤å®ƒä¼šå¯¼è‡´å›¾åˆ†è£‚æˆå¤šä¸ªå­å›¾ã€‚
    - ä¸€ä¸ªé¡¶ç‚¹æ˜¯å…³èŠ‚ç‚¹ï¼Œå½“ä¸”ä»…å½“ç§»é™¤è¯¥é¡¶ç‚¹åŠå…¶ç›¸å…³è¾¹åï¼Œå›¾çš„è¿é€šåˆ†é‡æ•°é‡å¢åŠ ã€‚
    
2. **åŒè¿é€šåˆ†é‡ï¼ˆBiconnected Componentsï¼‰**ï¼š
    - æ²¡æœ‰å…³èŠ‚ç‚¹çš„æå¤§å­å›¾ç§°ä¸ºåŒè¿é€šåˆ†é‡ã€‚
    - åŒè¿é€šåˆ†é‡ä¸­çš„ä»»æ„ä¸¤ç‚¹ä¹‹é—´è‡³å°‘å­˜åœ¨ä¸¤æ¡ä¸ç›¸äº¤çš„è·¯å¾„ã€‚
    
3. **DFS éå†**ï¼š
    - é€šè¿‡ DFS éå†å›¾ï¼Œè®°å½•æ¯ä¸ªé¡¶ç‚¹çš„å‘ç°æ—¶é—´ï¼ˆdï¼‰å’Œèƒ½åˆ°è¾¾çš„æœ€æ—©é¡¶ç‚¹çš„å‘ç°æ—¶é—´ï¼ˆLï¼‰ã€‚
    - å‘ç°æ—¶é—´ï¼ˆdï¼‰ï¼šé¡¶ç‚¹è¢«é¦–æ¬¡è®¿é—®çš„é¡ºåºï¼Œå³`dfs`åºå·ã€‚
    - æœ€æ—©å¯è¾¾æ—¶é—´ï¼ˆLï¼‰ï¼šé¡¶ç‚¹èƒ½é€šè¿‡æ ‘è¾¹ï¼ˆæ³¨æ„ï¼Œå› ä¸ºDFSæ˜¯ä¸è®¿é—®é¦–æ¬¡å‘ç°çš„é¡¶ç‚¹ï¼Œæ‰€ä»¥æ ‘è¾¹æ˜¯æœ‰å‘çš„Â `5â†’6`ï¼‰å’Œ**è‡³å¤šä¸€æ¡å›è¾¹**åˆ°è¾¾çš„**æœ€æ—©é¡¶ç‚¹**çš„`dfs`åºå·ã€‚
    
4. **æ˜¯å¦ä¸ºå…³èŠ‚ç‚¹çš„æ¡ä»¶ï¼š**
	- `L[v] â‰¥ d[u]`
	-  å› ä¸º`d[u]`æ˜¯`u`çš„`dfs`åºå·ï¼Œä»£è¡¨`u`åŠå…¶ç¥–å…ˆèŠ‚ç‚¹çš„è®¿é—®é¡ºåºï¼Œ`L[v]`æ˜¯`v`èƒ½åˆ°è¾¾çš„æœ€æ—©é¡¶ç‚¹çš„`dfs`åºå·ã€‚
	- è‹¥`L[v] â‰¥ d[u]`ï¼Œè¯´æ˜`v`åŠå…¶å­å­™èŠ‚ç‚¹èƒ½åˆ°è¾¾çš„æœ€æ—©é¡¶ç‚¹æœ€æ™šå°±æ˜¯`u`ï¼Œæ— æ³•åˆ°è¾¾`u`çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œæ‰€ä»¥åˆ é™¤`u`åï¼Œ`v`æ‰€åœ¨çš„å­æ ‘ä¼šä¸`u`çš„ç¥–å…ˆèŠ‚ç‚¹æ‰€åœ¨éƒ¨åˆ†åˆ†ç¦»ï¼Œå›¾ä¼šå˜æˆéè¿é€šå›¾ï¼Œå› æ­¤`u`æ˜¯å…³èŠ‚ç‚¹ã€‚
	- åä¹‹ï¼Œè‹¥ä¸å­˜åœ¨è¿™æ ·çš„å­èŠ‚ç‚¹`v`ä½¿å¾—`L[v] â‰¥ d[u]`ï¼Œåˆ™è¯´æ˜æ¯ä¸ªå­èŠ‚ç‚¹`v`åŠå…¶å­å­™éƒ½èƒ½é€šè¿‡å›è¾¹åˆ°è¾¾`u`çš„ç¥–å…ˆèŠ‚ç‚¹ï¼Œåˆ é™¤`u`åå›¾ä»ç„¶è¿é€šï¼Œ`u`ä¸æ˜¯å…³èŠ‚ç‚¹ã€‚
	
5. **ç¤ºä¾‹ï¼š**
    - å‘ç°æ—¶é—´Â `d[3] = 3`ã€‚
    - æœ€æ—©å¯è¾¾æ—¶é—´Â `L[3] = 3`ã€‚
    - å­èŠ‚ç‚¹ 5 çš„Â `L[5] = 3`ï¼Œæ»¡è¶³Â `L[5] â‰¥ d[3]`ï¼Œå› æ­¤é¡¶ç‚¹ 3 æ˜¯å…³èŠ‚ç‚¹ã€‚


---

## KMPç®—æ³•

LC 28

å­—ç¬¦ä¸²åŒ¹é…ä¸­ï¼Œè¦åœ¨æ›´é•¿çš„å­—ä¸²ä¸­æ‰¾å‡ºæ˜¯å¦åŒ…å«æ¨¡å¼ä¸²ï¼Œä½¿ç”¨ KMP ç®—æ³•ï¼Œæœ¬è´¨ä¸Šæ˜¯é€šè¿‡è·çŸ¥æ¨¡å¼ä¸²ä¸­çš„é‡å¤å­—ç¬¦ä¸²ï¼Œè®°å½•å‰ä¸€ä¸ªé‡å¤å­—ç¬¦ä¸²çš„æœ«å°¾ä½ç½®ï¼Œè¿›è¡Œè·³è½¬ï¼Œæ¥å‡å°‘é‡å¤ã€‚

- æ¯”å¦‚å¾…åŒ¹é…çš„æ¨¡å¼ä¸²æ˜¯ `s = "ABCABD"`
- å¯¹äºç¬¬äºŒä¸ªAæ¥è¯´ï¼Œç¬¬ä¸€ä¸ªAæ˜¯é‡å¤å­—ä¸²ï¼Œåˆ™è®°å½•å…¶æœ«å°¾ä½ç½®1
- å¯¹äºç¬¬äºŒä¸ªABæ¥è¯´ï¼Œç¬¬ä¸€ä¸ªABæ˜¯é‡å¤å­—ä¸²ï¼Œåˆ™è®°å½•å…¶æœ«å°¾ä½ç½®2
- å½“æœ€åDå’Œåˆ«çš„å­—ä¸²æ²¡åŒ¹é…ä¸Šæ—¶ï¼Œæ˜¾ç„¶èƒ½èµ°åˆ°è¿™é‡Œè¯´æ˜æ­¤æ—¶ä¸¤ä¸ªå­—ä¸²å‰é¢éƒ½æœ‰ABï¼Œï¼ˆæ¯”å¦‚...ABEå’Œ...ABDæ²¡åŒ¹é…ä¸Šï¼‰
- å› æ­¤ï¼Œæ¨¡å¼ä¸²ä¸­çš„æŒ‡é’ˆå…ˆä¸è·³åˆ°å¤´éƒ¨å¼€å§‹é‡æ–°åŒ¹é…ï¼Œè€Œæ˜¯è·³åˆ°ç¬¬ä¸€ä¸ªABç»“å°¾å¤„è¿›è¡Œå°è¯•ã€‚

æƒ³è¦è¢«åŒ¹é…çš„å­—ä¸²æ˜¯ `ABCABDABCABC`ã€‚
å½“åŒ¹é…åˆ° ABG æ‰€ä»¥å¤±è´¥æ—¶ï¼Œæˆ‘ä»¬å…ˆä¸ä»å¤´å°è¯•ï¼Œè€Œæ˜¯å¾€å‰æŒªåˆ°ä¸Šä¸€ä¸ªæœ‰é‡å¤å­—ç¬¦ä¸²ï¼ˆä¹Ÿå°±æ˜¯ABï¼‰å‡ºç°çš„ä½ç½®æœ«å°¾ï¼ˆå‰ç¼€å°¾ï¼‰å¼€å§‹å°è¯•ã€‚

**ä¸»è¦æ­¥éª¤**
1. é¢„å¤„ç†æ¨¡å¼ä¸²ï¼Œç”Ÿæˆä¸€ä¸ªéƒ¨åˆ†åŒ¹é…è¡¨ï¼ˆnextæ•°ç»„ï¼‰ã€‚
2. ä½¿ç”¨è¿™ä¸ªè¡¨è¿›è¡Œé«˜æ•ˆçš„å­—ç¬¦ä¸²åŒ¹é…ã€‚

**éƒ¨åˆ†åŒ¹é…è¡¨ï¼ˆnextæ•°ç»„ï¼‰**

å¯¹äºæ¨¡å¼ä¸²Wï¼ˆé•¿åº¦ä¸ºmï¼‰ï¼Œéƒ¨åˆ†åŒ¹é…è¡¨nextæ˜¯ä¸€ä¸ªé•¿åº¦ä¸ºmçš„æ•°ç»„ã€‚`next[i]`è¡¨ç¤ºåœ¨å­ä¸²`W[0:i]`ï¼ˆå‰i+1ä¸ªå­—ç¬¦ï¼‰ä¸­ï¼Œæœ€é•¿çš„ç›¸ç­‰çœŸå‰ç¼€ä¸çœŸåç¼€çš„é•¿åº¦ï¼ˆä¸åŒ…æ‹¬æ•´ä¸ªå­ä¸²ï¼‰ã€‚ä¾‹å¦‚æ¨¡å¼ä¸² "ABCDABD"å¯¹åº”çš„nextæ•°ç»„ï¼š

```
- next[0] = 0ï¼ˆå•ä¸ªå­—ç¬¦ï¼Œæ²¡æœ‰çœŸå‰ç¼€å’ŒçœŸåç¼€ï¼‰

- next[1] = 0ï¼ˆ"AB"ï¼ŒçœŸå‰ç¼€"A"ï¼ŒçœŸåç¼€"B"ï¼Œæ²¡æœ‰ç›¸ç­‰ï¼‰

- next[2] = 0ï¼ˆ"ABC"ï¼Œæ²¡æœ‰ç›¸ç­‰çš„çœŸå‰ç¼€å’ŒçœŸåç¼€ï¼‰

- next[3] = 0ï¼ˆ"ABCD"ï¼ŒåŒä¸Šï¼‰

- next[4] = 1ï¼ˆ"ABCDA"ï¼ŒçœŸå‰ç¼€"A"å’ŒçœŸåç¼€"A"ç›¸ç­‰ï¼Œé•¿åº¦ä¸º1ï¼‰

- next[5] = 2ï¼ˆ"ABCDAB"ï¼ŒçœŸå‰ç¼€"AB"å’ŒçœŸåç¼€"AB"ç›¸ç­‰ï¼Œé•¿åº¦ä¸º2ï¼‰

- next[6] = 0ï¼ˆ"ABCDABD"ï¼Œæ²¡æœ‰ç›¸ç­‰çš„çœŸå‰ç¼€å’ŒçœŸåç¼€ï¼‰
```

**æ„å»ºnextæ•°ç»„çš„æ­¥éª¤ï¼ˆé¢„å¤„ç†ï¼‰**

```
1. åˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆï¼šiï¼ˆåç¼€æœ«å°¾ï¼‰å’Œ jï¼ˆå‰ç¼€æœ«å°¾ï¼Œä¹Ÿè¡¨ç¤ºå½“å‰æœ€é•¿ç›¸ç­‰å‰åç¼€çš„é•¿åº¦ï¼‰

2. åˆå§‹åŒ–next[0] = 0

3. éå†æ¨¡å¼ä¸²ï¼ˆiä»1åˆ°m-1ï¼‰ï¼š

- å¦‚æœå½“å‰å­—ç¬¦W[i]ç­‰äºW[j]ï¼Œåˆ™jå¢åŠ 1ï¼Œnext[i]=jï¼Œç„¶åiå¢åŠ 1ã€‚

- å¦‚æœä¸ç›¸ç­‰ï¼š

- å¦‚æœjä¸º0ï¼Œåˆ™next[i]=0ï¼Œiå¢åŠ 1ã€‚

- å¦åˆ™ï¼Œä»¤j = next[j-1]ï¼ˆå›é€€åˆ°å‰ä¸€ä¸ªä½ç½®çš„æœ€é•¿å‰ç¼€å¤„ï¼‰
```

æ¨¡å¼ä¸²ï¼šW = "ABABC"

```
- m = 5

- next[0] = 0ï¼ˆåˆå§‹åŒ–ï¼‰

- i=1, j=0: W[1]='B' != W[0]='A' -> j=0, æ‰€ä»¥next[1]=0, i++

- i=2, j=0: W[2]='A' == W[0]='A' -> j=1, next[2]=1, i++

- i=3, j=1: W[3]='B' == W[1]='B' -> j=2, next[3]=2, i++

- i=4, j=2: W[4]='C' != W[2]='A' -> j>0, æ‰€ä»¥j=next[1]=0ï¼ˆå› ä¸ºnext[j-1]=next[1]=0ï¼‰

ç„¶åæ¯”è¾ƒW[4]å’ŒW[0]ï¼šä¸ç›¸ç­‰ï¼Œä¸”j=0ï¼Œæ‰€ä»¥next[4]=0, i++ï¼ˆç»“æŸï¼‰

nextæ•°ç»„ï¼š[0, 0, 1, 2, 0]
```

**åŒ¹é…è¿‡ç¨‹**

```
1. åˆå§‹åŒ–ä¸¤ä¸ªæŒ‡é’ˆï¼šiï¼ˆä¸»ä¸²Sçš„æŒ‡é’ˆï¼‰å’Œjï¼ˆæ¨¡å¼ä¸²Wçš„æŒ‡é’ˆï¼‰

2. éå†ä¸»ä¸²Sï¼ˆiä»0åˆ°n-1ï¼‰ï¼š

- å¦‚æœS[i]ç­‰äºW[j]ï¼Œåˆ™iå’ŒjåŒæ—¶å¢åŠ 1ã€‚

- å¦‚æœä¸ç›¸ç­‰ï¼š

- å¦‚æœjå¤§äº0ï¼Œåˆ™j = next[j-1]ï¼ˆåˆ©ç”¨éƒ¨åˆ†åŒ¹é…è¡¨è·³è¿‡ä¸€äº›å­—ç¬¦ï¼‰

- å¦åˆ™ï¼ˆjä¸º0ï¼‰ï¼Œiå¢åŠ 1ï¼ˆæ¨¡å¼ä¸²å·²ç»æ— æ³•å›é€€ï¼Œä¸»ä¸²æŒ‡é’ˆåç§»ï¼‰

3. å¦‚æœjç­‰äºæ¨¡å¼ä¸²é•¿åº¦mï¼Œåˆ™åŒ¹é…æˆåŠŸï¼Œè¿”å›åŒ¹é…çš„èµ·å§‹ä½ç½®i-mï¼›ç„¶åä¸ºäº†ç»§ç»­åŒ¹é…ï¼Œå¯ä»¥ä»¤j = next[j-1]ï¼ˆå¯»æ‰¾ä¸‹ä¸€ä¸ªå¯èƒ½çš„åŒ¹é…ï¼‰
```

ä¸»ä¸²S = "ABABABABC"

```
æ¨¡å¼ä¸²W = "ABABC", next = [0,0,1,2,0]

i=0, j=0: S[0]='A'==W[0] -> i=1, j=1

i=1, j=1: S[1]='B'==W[1] -> i=2, j=2

i=2, j=2: S[2]='A'==W[2] -> i=3, j=3

i=3, j=3: S[3]='B'==W[3] -> i=4, j=4

i=4, j=4: S[4]='A'!=W[4]='C' -> j>0, j=next[3]=2

ç°åœ¨æ¯”è¾ƒS[4]å’ŒW[2]ï¼šS[4]='A'==W[2]='A' -> i=5, j=3

i=5, j=3: S[5]='B'==W[3]='B' -> i=6, j=4

i=6, j=4: S[6]='A'!=W[4]='C' -> j>0, j=next[3]=2

æ¯”è¾ƒS[6]å’ŒW[2]ï¼šç›¸ç­‰ï¼Œi=7, j=3

i=7, j=3: S[7]='B'==W[3]='B' -> i=8, j=4

i=8, j=4: S[8]='C'==W[4]='C' -> j=5ï¼ŒåŒ¹é…æˆåŠŸï¼Œè¿”å›ä½ç½®8-4=4

æ‰€ä»¥åŒ¹é…ä½ç½®ä»4å¼€å§‹ï¼ˆå³S[4]åˆ°S[8]ï¼‰ã€‚
```

**KMPç®—æ³•çš„æ—¶é—´å¤æ‚åº¦**

- é¢„å¤„ç†ï¼šO(m)ï¼Œå…¶ä¸­mæ˜¯æ¨¡å¼ä¸²çš„é•¿åº¦ã€‚
- åŒ¹é…ï¼šO(n)ï¼Œå…¶ä¸­næ˜¯ä¸»ä¸²çš„é•¿åº¦ã€‚
- å› æ­¤æ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(n+m)ã€‚


